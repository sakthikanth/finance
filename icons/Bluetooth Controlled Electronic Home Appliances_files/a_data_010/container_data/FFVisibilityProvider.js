EBG.declareNamespace("RichModules");EBG.RichModules.FFVisibilityProvider=function (resourceObjId,adConfig,options){EBG.callSuperConstructor(EBG.RichModules.FFVisibilityProvider,this,[resourceObjId,adConfig,options]);};EBG.RichModules.FFVisibilityProvider.prototype={name:"FF",_focusOnResourceElem:null,_justReceivedFocusOnPage:null,_reachedMaxAdDuration:false,_getInnerFrameTopLeft:function (){return EBG.adaptor.getIframePosition();},_getViewPortRect:function (){var viewPortSize=this._getViewPortMetrics();var top=this._adConfig.ffs["CFF_FFVisMultiScreen"]?~~window.screenY:Math.max(0,~~window.screenY);var left=this._adConfig.ffs["CFF_FFVisMultiScreen"]?~~window.screenX:Math.max(0,~~window.screenX);return {top:top+(window.fullScreen?0:70),left:left,right:left+viewPortSize.Width,bottom:top+viewPortSize.Height};},_getViewPortMetrics:function (){var win=this.adConfig.displayWin||EBG.adaptor.getDisplayWin();var heightWidth={Height:0,Width:0};if(EBG.isDefined(win.outerWidth)&&(win.outerWidth>0||win.outerHeight>0)){heightWidth.Width=win.outerWidth;heightWidth.Height=win.outerHeight;}else if(EBG.isDefined(win.screen.availWidth)){heightWidth.Width=win.screen.availWidth;heightWidth.Height=win.screen.availHeight;}if(EBG.isDefined(win.scrollMaxX)&&win.scrollMaxX>0&&EBG.isDefined(EBG.adaptor.scrollBarWidth)&&EBG.adaptor.scrollBarWidth>0){heightWidth.Height-=EBG.adaptor.scrollBarWidth;}if(EBG.isDefined(win.scrollMaxY)&&win.scrollMaxY>0&&EBG.isDefined(EBG.adaptor.scrollBarHeight)&&EBG.adaptor.scrollBarHeight>0){heightWidth.Width-=EBG.adaptor.scrollBarHeight;}return heightWidth;},_subscribeToEvents:function (){EBG.runTimed(this,this._visibilityPollingCheck,[],EBG.RichModules.VisibilityManager.VisibilityPollingTimer);},_visibilityPollingCheck:function (){var $this=this;if(!this._reachedMaxAdDuration){var res=this._calculateVisibilityResult();this._dispatchCheckVisibility(res);EBG.runTimed($this,$this._visibilityPollingCheck,[],EBG.RichModules.VisibilityManager.VisibilityPollingTimer);}},_getAssetRect:function (id){var rect=EBGInfra.callSuperFunction(EBG.RichModules.FFVisibilityProvider,this,"_getAssetRect",[id]);rect.top+=~~window.mozInnerScreenY;rect.left+=~~window.mozInnerScreenX;rect.bottom+=~~window.mozInnerScreenY;rect.right+=~~window.mozInnerScreenX;return rect;}};EBG.declareClass(EBG.RichModules.FFVisibilityProvider,EBG.RichModules.GeometricVisibilityProvider);